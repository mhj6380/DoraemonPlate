{"ast":null,"code":"import _regeneratorRuntime from \"/Users/munhagju/DoraemonPlateV1/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/munhagju/DoraemonPlateV1/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/munhagju/DoraemonPlateV1/frontend/components/contexts/profile/UserProfileProvider.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useMemo } from \"react\";\nimport UserProfileContext from \"./UserProfileContext\";\nexport var UserProfileProvider = function UserProfileProvider(_ref) {\n  _s();\n\n  var children = _ref.children;\n\n  var _useState = useState(null),\n      ua = _useState[0],\n      setUa = _useState[1];\n\n  var _useState2 = useState(null),\n      name = _useState2[0],\n      setName = _useState2[1]; // fetch user agent and set \"ua\"\n\n\n  useEffect(function () {\n    if (false) {\n      return;\n    }\n\n    var mounted = true;\n    fetch(\"/api/ua\").then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(res) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!mounted || res.status !== 200)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                _context.t0 = setUa;\n                _context.next = 5;\n                return res.json();\n\n              case 5:\n                _context.t1 = _context.sent;\n                (0, _context.t0)(_context.t1);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    return function () {\n      return mounted = false;\n    };\n  }, []);\n  var data = useMemo(function () {\n    return {\n      ua: ua,\n\n      get name() {\n        return name;\n      },\n\n      /** allow setting name from child components */\n      set name(val) {\n        setName(val);\n      }\n\n    };\n  }, [ua, name]);\n  return /*#__PURE__*/_jsxDEV(UserProfileContext.Provider, {\n    value: data,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(UserProfileProvider, \"S6mBmIDRpDZ+5NHGBWdLyAXONTk=\");\n\n_c = UserProfileProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProfileProvider\");","map":{"version":3,"sources":["/Users/munhagju/DoraemonPlateV1/frontend/components/contexts/profile/UserProfileProvider.tsx"],"names":["useState","useEffect","useMemo","UserProfileContext","UserProfileProvider","children","ua","setUa","name","setName","mounted","fetch","then","res","status","json","data","val"],"mappings":";;;;;;;;AAAA,SAAaA,QAAb,EAAuBC,SAAvB,EAAkCC,OAAlC,QAAiD,OAAjD;AAGA,OAAOC,kBAAP,MAA+B,sBAA/B;AAEA,OAAO,IAAMC,mBAAuB,GAAG,SAA1BA,mBAA0B,OAAkB;AAAA;;AAAA,MAAfC,QAAe,QAAfA,QAAe;;AAAA,kBACnCL,QAAQ,CAAoB,IAApB,CAD2B;AAAA,MAChDM,EADgD;AAAA,MAC5CC,KAD4C;;AAAA,mBAE/BP,QAAQ,CAAS,IAAT,CAFuB;AAAA,MAEhDQ,IAFgD;AAAA,MAE1CC,OAF0C,kBAIvD;;;AACAR,EAAAA,SAAS,CAAC,YAAM;AACd,eAAmC;AACjC;AACD;;AACD,QAAIS,OAAO,GAAG,IAAd;AACAC,IAAAA,KAAK,CAAC,SAAD,CAAL,CAAiBC,IAAjB;AAAA,2EAAsB,iBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA,sBAChB,CAACH,OAAD,IAAYG,GAAG,CAACC,MAAJ,KAAe,GADX;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,8BAIpBP,KAJoB;AAAA;AAAA,uBAIRM,GAAG,CAACE,IAAJ,EAJQ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAtB;;AAAA;AAAA;AAAA;AAAA;AAMA,WAAO;AAAA,aAAOL,OAAO,GAAG,KAAjB;AAAA,KAAP;AACD,GAZQ,EAYN,EAZM,CAAT;AAcA,MAAMM,IAAsB,GAAGd,OAAO,CACpC;AAAA,WAAO;AACLI,MAAAA,EAAE,EAAFA,EADK;;AAEL,UAAIE,IAAJ,GAAW;AACT,eAAOA,IAAP;AACD,OAJI;;AAKL;AACA,UAAIA,IAAJ,CAASS,GAAT,EAAc;AACZR,QAAAA,OAAO,CAACQ,GAAD,CAAP;AACD;;AARI,KAAP;AAAA,GADoC,EAWpC,CAACX,EAAD,EAAKE,IAAL,CAXoC,CAAtC;AAcA,sBACE,QAAC,kBAAD,CAAoB,QAApB;AAA6B,IAAA,KAAK,EAAEQ,IAApC;AAAA,cACGX;AADH;AAAA;AAAA;AAAA;AAAA,WADF;AAKD,CAtCM;;GAAMD,mB;;KAAAA,mB","sourcesContent":["import { FC, useState, useEffect, useMemo } from \"react\";\r\n\r\nimport { UserProfileIface } from \"../../../shared/UserProfileIface\";\r\nimport UserProfileContext from \"./UserProfileContext\";\r\n\r\nexport const UserProfileProvider: FC = ({ children }) => {\r\n  const [ua, setUa] = useState<IUAParser.IResult>(null);\r\n  const [name, setName] = useState<string>(null);\r\n\r\n  // fetch user agent and set \"ua\"\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") {\r\n      return;\r\n    }\r\n    let mounted = true;\r\n    fetch(\"/api/ua\").then(async (res) => {\r\n      if (!mounted || res.status !== 200) {\r\n        return;\r\n      }\r\n      setUa(await res.json());\r\n    });\r\n    return () => (mounted = false);\r\n  }, []);\r\n\r\n  const data: UserProfileIface = useMemo(\r\n    () => ({\r\n      ua,\r\n      get name() {\r\n        return name;\r\n      },\r\n      /** allow setting name from child components */\r\n      set name(val) {\r\n        setName(val);\r\n      },\r\n    }),\r\n    [ua, name]\r\n  );\r\n\r\n  return (\r\n    <UserProfileContext.Provider value={data}>\r\n      {children}\r\n    </UserProfileContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}